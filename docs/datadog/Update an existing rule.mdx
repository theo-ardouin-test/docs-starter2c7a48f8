---
id: update-security-monitoring-rule
title: "Update an existing rule"
description: "Update an existing rule. When updating `cases`, `queries` or `options`, the whole field"
sidebar_label: "Update an existing rule"
hide_title: true
hide_table_of_contents: true
api: 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
sidebar_class_name: "put api-method"
info_path: docs/datadog/datadog-api-v-2-collection
custom_edit_url: null
---

<h1 className={"openapi__heading"}>Update an existing rule</h1>

<MethodEndpoint method={"put"} path={"/api/v2/security_monitoring/rules/{rule_id}"}></MethodEndpoint>


Update an existing rule. When updating `cases`, `queries` or `options`, the whole fieldmust be included. For example, when modifying a query all queries must be included.Default rules can only be updated to be enabled and to change notifications.
## Request
<details style={{"marginBottom":"1rem"}} className={"openapi-markdown__details"} data-collapsed={false} open={true}><summary style={{}}><h3 className={"openapi-markdown__details-summary-header-params"}>Path Parameters</h3></summary><div><ul><ParamsItem className={"paramsItem"} param={{"description":"The ID of the rule.","in":"path","name":"rule_id","required":true,"schema":{"type":"string"}}}></ParamsItem></ul></div></details>
<MimeTabs className={"openapi-tabs__mime request"}><TabItem label={"application/json"} value={"application/json-schema"}><details style={{}} className={"openapi-markdown__details mime"} data-collapsed={false} open={true}><summary style={{}} className={"openapi-markdown__details-summary-mime"}><h3 className={"openapi-markdown__details-summary-header-body"}>Body</h3><strong className={"openapi-schema__required"}>required</strong></summary><div className={"body-description-container"}></div><ul style={{"marginLeft":"5px"}}><SchemaItem collapsible={true} className={"schemaItem"}><details style={{}} className={"openapi-markdown__details"}><summary style={{}}><span className={"openapi-schema__container"}><strong className={"openapi-schema__property"}>cases</strong><span className={"openapi-schema__name"}> object[]</span></span></summary><div style={{"marginLeft":"5px"}} className={"schema-description-container"}><div className={"schema-description"}>Cases for generating signals.</div><li className={"opening-array-bracket-container"}><div className={"opening-array-bracket"}>Array [</div></li><SchemaItem collapsible={false} name={"condition"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"A rule case contains logical operations (`>`,`>=`, `&&`, `||`) to determine if a signal should be generated\nbased on the event counts in the previously defined queries.","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"name"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Name of the case.","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"notifications"} required={false} schemaName={"string[]"} qualifierMessage={undefined} schema={{"description":"Notification targets for each rule case.","items":{"description":"Notification.","type":"string"},"type":"array"}}></SchemaItem><SchemaItem collapsible={false} name={"status"} required={false} schemaName={"SecurityMonitoringRuleSeverity"} qualifierMessage={"**Possible values:** [`info`, `low`, `medium`, `high`, `critical`]"} schema={{"description":"Severity of the Security Signal.","enum":["info","low","medium","high","critical"],"example":"critical","type":"string","x-enum-varnames":["INFO","LOW","MEDIUM","HIGH","CRITICAL"],"title":"SecurityMonitoringRuleSeverity"}}></SchemaItem><li className={"closing-array-bracket-container"}><div className={"closing-array-bracket"}>]</div></li></div></details></SchemaItem><SchemaItem collapsible={true} className={"schemaItem"}><details style={{}} className={"openapi-markdown__details"}><summary style={{}}><span className={"openapi-schema__container"}><strong className={"openapi-schema__property"}>filters</strong><span className={"openapi-schema__name"}> object[]</span></span></summary><div style={{"marginLeft":"5px"}} className={"schema-description-container"}><div className={"schema-description"}>Additional queries to filter matched events before they are processed.</div><li className={"opening-array-bracket-container"}><div className={"opening-array-bracket"}>Array [</div></li><SchemaItem collapsible={false} name={"action"} required={false} schemaName={"SecurityMonitoringFilterAction"} qualifierMessage={"**Possible values:** [`require`, `suppress`]"} schema={{"description":"The type of filtering action.","enum":["require","suppress"],"type":"string","x-enum-varnames":["REQUIRE","SUPPRESS"],"title":"SecurityMonitoringFilterAction"}}></SchemaItem><SchemaItem collapsible={false} name={"query"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Query for selecting logs to apply the filtering action.","type":"string"}}></SchemaItem><li className={"closing-array-bracket-container"}><div className={"closing-array-bracket"}>]</div></li></div></details></SchemaItem><SchemaItem collapsible={false} name={"hasExtendedTitle"} required={false} schemaName={"boolean"} qualifierMessage={undefined} schema={{"description":"Whether the notifications include the triggering group-by values in their title.","example":true,"type":"boolean"}}></SchemaItem><SchemaItem collapsible={false} name={"isEnabled"} required={false} schemaName={"boolean"} qualifierMessage={undefined} schema={{"description":"Whether the rule is enabled.","type":"boolean"}}></SchemaItem><SchemaItem collapsible={false} name={"message"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Message for generated signals.","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"name"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Name of the rule.","type":"string"}}></SchemaItem><SchemaItem collapsible={true} className={"schemaItem"}><details style={{}} className={"openapi-markdown__details"}><summary style={{}}><span className={"openapi-schema__container"}><strong className={"openapi-schema__property"}>options</strong><span className={"openapi-schema__name"}> object</span></span></summary><div style={{"marginLeft":"5px"}} className={"schema-description-container"}><div className={"schema-description"}>Options on rules.</div><SchemaItem collapsible={false} name={"detectionMethod"} required={false} schemaName={"SecurityMonitoringRuleDetectionMethod"} qualifierMessage={"**Possible values:** [`threshold`, `new_value`, `anomaly_detection`]"} schema={{"description":"The detection method.","enum":["threshold","new_value","anomaly_detection"],"type":"string","x-enum-varnames":["THRESHOLD","NEW_VALUE","ANOMALY_DETECTION"],"title":"SecurityMonitoringRuleDetectionMethod"}}></SchemaItem><SchemaItem collapsible={false} name={"evaluationWindow"} required={false} schemaName={"int32"} qualifierMessage={"**Possible values:** [`0`, `60`, `300`, `600`, `900`, `1800`, `3600`, `7200`]"} schema={{"description":"A time window is specified to match when at least one of the cases matches true. This is a sliding window\nand evaluates in real time.","enum":[0,60,300,600,900,1800,3600,7200],"format":"int32","type":"integer","x-enum-varnames":["ZERO_MINUTES","ONE_MINUTE","FIVE_MINUTES","TEN_MINUTES","FIFTEEN_MINUTES","THIRTY_MINUTES","ONE_HOUR","TWO_HOURS"],"title":"SecurityMonitoringRuleEvaluationWindow"}}></SchemaItem><SchemaItem collapsible={false} name={"keepAlive"} required={false} schemaName={"int32"} qualifierMessage={"**Possible values:** [`0`, `60`, `300`, `600`, `900`, `1800`, `3600`, `7200`, `10800`, `21600`]"} schema={{"description":"Once a signal is generated, the signal will remain “open” if a case is matched at least once within\nthis keep alive window.","enum":[0,60,300,600,900,1800,3600,7200,10800,21600],"format":"int32","type":"integer","x-enum-varnames":["ZERO_MINUTES","ONE_MINUTE","FIVE_MINUTES","TEN_MINUTES","FIFTEEN_MINUTES","THIRTY_MINUTES","ONE_HOUR","TWO_HOURS","THREE_HOURS","SIX_HOURS"],"title":"SecurityMonitoringRuleKeepAlive"}}></SchemaItem><SchemaItem collapsible={false} name={"maxSignalDuration"} required={false} schemaName={"int32"} qualifierMessage={"**Possible values:** [`0`, `60`, `300`, `600`, `900`, `1800`, `3600`, `7200`, `10800`, `21600`, `43200`, `86400`]"} schema={{"description":"A signal will “close” regardless of the query being matched once the time exceeds the maximum duration.\nThis time is calculated from the first seen timestamp.","enum":[0,60,300,600,900,1800,3600,7200,10800,21600,43200,86400],"format":"int32","type":"integer","x-enum-varnames":["ZERO_MINUTES","ONE_MINUTE","FIVE_MINUTES","TEN_MINUTES","FIFTEEN_MINUTES","THIRTY_MINUTES","ONE_HOUR","TWO_HOURS","THREE_HOURS","SIX_HOURS","TWELVE_HOURS","ONE_DAY"],"title":"SecurityMonitoringRuleMaxSignalDuration"}}></SchemaItem><SchemaItem collapsible={true} className={"schemaItem"}><details style={{}} className={"openapi-markdown__details"}><summary style={{}}><span className={"openapi-schema__container"}><strong className={"openapi-schema__property"}>newValueOptions</strong><span className={"openapi-schema__name"}> object</span></span></summary><div style={{"marginLeft":"5px"}} className={"schema-description-container"}><div className={"schema-description"}>Options on new value rules.</div><SchemaItem collapsible={false} name={"forgetAfter"} required={false} schemaName={"int32"} qualifierMessage={"**Possible values:** [`1`, `2`, `7`, `14`, `21`, `28`]"} schema={{"description":"The duration in days after which a learned value is forgotten.","enum":[1,2,7,14,21,28],"format":"int32","type":"integer","x-enum-varnames":["ONE_DAY","TWO_DAYS","ONE_WEEK","TWO_WEEKS","THREE_WEEKS","FOUR_WEEKS"],"title":"SecurityMonitoringRuleNewValueOptionsForgetAfter"}}></SchemaItem><SchemaItem collapsible={false} name={"learningDuration"} required={false} schemaName={"int32"} qualifierMessage={"**Possible values:** [`0`, `1`, `7`]"} schema={{"description":"The duration in days during which values are learned, and after which signals will be generated for values that\nweren't learned. If set to 0, a signal will be generated for all new values after the first value is learned.","enum":[0,1,7],"format":"int32","type":"integer","x-enum-varnames":["ZERO_DAYS","ONE_DAY","SEVEN_DAYS"],"title":"SecurityMonitoringRuleNewValueOptionsLearningDuration"}}></SchemaItem></div></details></SchemaItem></div></details></SchemaItem><SchemaItem collapsible={true} className={"schemaItem"}><details style={{}} className={"openapi-markdown__details"}><summary style={{}}><span className={"openapi-schema__container"}><strong className={"openapi-schema__property"}>queries</strong><span className={"openapi-schema__name"}> object[]</span></span></summary><div style={{"marginLeft":"5px"}} className={"schema-description-container"}><div className={"schema-description"}>Queries for selecting logs which are part of the rule.</div><li className={"opening-array-bracket-container"}><div className={"opening-array-bracket"}>Array [</div></li><SchemaItem collapsible={true} className={"schemaItem"}><details style={{}} className={"openapi-markdown__details"}><summary style={{}}><span className={"openapi-schema__container"}><strong className={"openapi-schema__property"}>agentRule</strong><span className={"openapi-schema__name"}> object</span></span></summary><div style={{"marginLeft":"5px"}} className={"schema-description-container"}><div className={"schema-description"}>The Agent rule.</div><SchemaItem collapsible={false} name={"agentRuleId"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"The Agent rule ID. Must be unique within the rule.","example":"etc_shadow","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"expression"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"A Runtime Security expression determines what activity should be collected by the Datadog Agent.\nThese logical expressions can use predefined operators and attributes. Tags cannot be used in Runtime\nSecurity expressions. Instead, allow or deny based on tags under the advanced option.","type":"string"}}></SchemaItem></div></details></SchemaItem><SchemaItem collapsible={false} name={"aggregation"} required={false} schemaName={"SecurityMonitoringRuleQueryAggregation"} qualifierMessage={"**Possible values:** [`count`, `cardinality`, `sum`, `max`, `new_value`]"} schema={{"description":"The aggregation type.","enum":["count","cardinality","sum","max","new_value"],"type":"string","x-enum-varnames":["COUNT","CARDINALITY","SUM","MAX","NEW_VALUE"],"title":"SecurityMonitoringRuleQueryAggregation"}}></SchemaItem><SchemaItem collapsible={false} name={"distinctFields"} required={false} schemaName={"string[]"} qualifierMessage={undefined} schema={{"description":"Field for which the cardinality is measured. Sent as an array.","items":{"description":"Field.","type":"string"},"type":"array"}}></SchemaItem><SchemaItem collapsible={false} name={"groupByFields"} required={false} schemaName={"string[]"} qualifierMessage={undefined} schema={{"description":"Fields to group by.","items":{"description":"Field.","type":"string"},"type":"array"}}></SchemaItem><SchemaItem collapsible={false} name={"metric"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"The target field to aggregate over when using the sum or max\naggregations.","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"name"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Name of the query.","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"query"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Query to run on logs.","type":"string"}}></SchemaItem><li className={"closing-array-bracket-container"}><div className={"closing-array-bracket"}>]</div></li></div></details></SchemaItem><SchemaItem collapsible={false} name={"tags"} required={false} schemaName={"string[]"} qualifierMessage={undefined} schema={{"description":"Tags for generated signals.","items":{"description":"Tag.","type":"string"},"type":"array"}}></SchemaItem><SchemaItem collapsible={false} name={"version"} required={false} schemaName={"int32"} qualifierMessage={"**Possible values:** `<= 2147483647`"} schema={{"description":"The version of the rule being updated.","example":1,"format":"int32","maximum":2147483647,"type":"integer"}}></SchemaItem></ul></details></TabItem></MimeTabs>
<div><div><ApiTabs label={undefined} id={undefined}><TabItem label={"200"} value={"200"}><div>OK</div><div><MimeTabs className={"openapi-tabs__mime"} schemaType={"response"}><TabItem label={"application/json"} value={"application/json"}><SchemaTabs className={"openapi-tabs__schema"}><TabItem label={"Schema"} value={"Schema"}><details style={{}} className={"openapi-markdown__details response"} data-collapsed={false} open={true}><summary style={{}} className={"openapi-markdown__details-summary-response"}><strong>Schema</strong></summary><div style={{"textAlign":"left","marginLeft":"1rem"}} className={"response-body-description-container"}></div><ul style={{"marginLeft":"5px"}}><SchemaItem collapsible={true} className={"schemaItem"}><details style={{}} className={"openapi-markdown__details"}><summary style={{}}><span className={"openapi-schema__container"}><strong className={"openapi-schema__property"}>cases</strong><span className={"openapi-schema__name"}> object[]</span></span></summary><div style={{"marginLeft":"5px"}} className={"schema-description-container"}><div className={"schema-description"}>Cases for generating signals.</div><li className={"opening-array-bracket-container"}><div className={"opening-array-bracket"}>Array [</div></li><SchemaItem collapsible={false} name={"condition"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"A rule case contains logical operations (`>`,`>=`, `&&`, `||`) to determine if a signal should be generated\nbased on the event counts in the previously defined queries.","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"name"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Name of the case.","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"notifications"} required={false} schemaName={"string[]"} qualifierMessage={undefined} schema={{"description":"Notification targets for each rule case.","items":{"description":"Notification.","type":"string"},"type":"array"}}></SchemaItem><SchemaItem collapsible={false} name={"status"} required={false} schemaName={"SecurityMonitoringRuleSeverity"} qualifierMessage={"**Possible values:** [`info`, `low`, `medium`, `high`, `critical`]"} schema={{"description":"Severity of the Security Signal.","enum":["info","low","medium","high","critical"],"example":"critical","type":"string","x-enum-varnames":["INFO","LOW","MEDIUM","HIGH","CRITICAL"],"title":"SecurityMonitoringRuleSeverity"}}></SchemaItem><li className={"closing-array-bracket-container"}><div className={"closing-array-bracket"}>]</div></li></div></details></SchemaItem><SchemaItem collapsible={false} name={"createdAt"} required={false} schemaName={"int64"} qualifierMessage={undefined} schema={{"description":"When the rule was created, timestamp in milliseconds.","format":"int64","type":"integer"}}></SchemaItem><SchemaItem collapsible={false} name={"creationAuthorId"} required={false} schemaName={"int64"} qualifierMessage={undefined} schema={{"description":"User ID of the user who created the rule.","format":"int64","type":"integer"}}></SchemaItem><SchemaItem collapsible={true} className={"schemaItem"}><details style={{}} className={"openapi-markdown__details"}><summary style={{}}><span className={"openapi-schema__container"}><strong className={"openapi-schema__property"}>filters</strong><span className={"openapi-schema__name"}> object[]</span></span></summary><div style={{"marginLeft":"5px"}} className={"schema-description-container"}><div className={"schema-description"}>Additional queries to filter matched events before they are processed.</div><li className={"opening-array-bracket-container"}><div className={"opening-array-bracket"}>Array [</div></li><SchemaItem collapsible={false} name={"action"} required={false} schemaName={"SecurityMonitoringFilterAction"} qualifierMessage={"**Possible values:** [`require`, `suppress`]"} schema={{"description":"The type of filtering action.","enum":["require","suppress"],"type":"string","x-enum-varnames":["REQUIRE","SUPPRESS"],"title":"SecurityMonitoringFilterAction"}}></SchemaItem><SchemaItem collapsible={false} name={"query"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Query for selecting logs to apply the filtering action.","type":"string"}}></SchemaItem><li className={"closing-array-bracket-container"}><div className={"closing-array-bracket"}>]</div></li></div></details></SchemaItem><SchemaItem collapsible={false} name={"hasExtendedTitle"} required={false} schemaName={"boolean"} qualifierMessage={undefined} schema={{"description":"Whether the notifications include the triggering group-by values in their title.","type":"boolean"}}></SchemaItem><SchemaItem collapsible={false} name={"id"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"The ID of the rule.","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"isDefault"} required={false} schemaName={"boolean"} qualifierMessage={undefined} schema={{"description":"Whether the rule is included by default.","type":"boolean"}}></SchemaItem><SchemaItem collapsible={false} name={"isDeleted"} required={false} schemaName={"boolean"} qualifierMessage={undefined} schema={{"description":"Whether the rule has been deleted.","type":"boolean"}}></SchemaItem><SchemaItem collapsible={false} name={"isEnabled"} required={false} schemaName={"boolean"} qualifierMessage={undefined} schema={{"description":"Whether the rule is enabled.","type":"boolean"}}></SchemaItem><SchemaItem collapsible={false} name={"message"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Message for generated signals.","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"name"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"The name of the rule.","type":"string"}}></SchemaItem><SchemaItem collapsible={true} className={"schemaItem"}><details style={{}} className={"openapi-markdown__details"}><summary style={{}}><span className={"openapi-schema__container"}><strong className={"openapi-schema__property"}>options</strong><span className={"openapi-schema__name"}> object</span></span></summary><div style={{"marginLeft":"5px"}} className={"schema-description-container"}><div className={"schema-description"}>Options on rules.</div><SchemaItem collapsible={false} name={"detectionMethod"} required={false} schemaName={"SecurityMonitoringRuleDetectionMethod"} qualifierMessage={"**Possible values:** [`threshold`, `new_value`, `anomaly_detection`]"} schema={{"description":"The detection method.","enum":["threshold","new_value","anomaly_detection"],"type":"string","x-enum-varnames":["THRESHOLD","NEW_VALUE","ANOMALY_DETECTION"],"title":"SecurityMonitoringRuleDetectionMethod"}}></SchemaItem><SchemaItem collapsible={false} name={"evaluationWindow"} required={false} schemaName={"int32"} qualifierMessage={"**Possible values:** [`0`, `60`, `300`, `600`, `900`, `1800`, `3600`, `7200`]"} schema={{"description":"A time window is specified to match when at least one of the cases matches true. This is a sliding window\nand evaluates in real time.","enum":[0,60,300,600,900,1800,3600,7200],"format":"int32","type":"integer","x-enum-varnames":["ZERO_MINUTES","ONE_MINUTE","FIVE_MINUTES","TEN_MINUTES","FIFTEEN_MINUTES","THIRTY_MINUTES","ONE_HOUR","TWO_HOURS"],"title":"SecurityMonitoringRuleEvaluationWindow"}}></SchemaItem><SchemaItem collapsible={false} name={"keepAlive"} required={false} schemaName={"int32"} qualifierMessage={"**Possible values:** [`0`, `60`, `300`, `600`, `900`, `1800`, `3600`, `7200`, `10800`, `21600`]"} schema={{"description":"Once a signal is generated, the signal will remain “open” if a case is matched at least once within\nthis keep alive window.","enum":[0,60,300,600,900,1800,3600,7200,10800,21600],"format":"int32","type":"integer","x-enum-varnames":["ZERO_MINUTES","ONE_MINUTE","FIVE_MINUTES","TEN_MINUTES","FIFTEEN_MINUTES","THIRTY_MINUTES","ONE_HOUR","TWO_HOURS","THREE_HOURS","SIX_HOURS"],"title":"SecurityMonitoringRuleKeepAlive"}}></SchemaItem><SchemaItem collapsible={false} name={"maxSignalDuration"} required={false} schemaName={"int32"} qualifierMessage={"**Possible values:** [`0`, `60`, `300`, `600`, `900`, `1800`, `3600`, `7200`, `10800`, `21600`, `43200`, `86400`]"} schema={{"description":"A signal will “close” regardless of the query being matched once the time exceeds the maximum duration.\nThis time is calculated from the first seen timestamp.","enum":[0,60,300,600,900,1800,3600,7200,10800,21600,43200,86400],"format":"int32","type":"integer","x-enum-varnames":["ZERO_MINUTES","ONE_MINUTE","FIVE_MINUTES","TEN_MINUTES","FIFTEEN_MINUTES","THIRTY_MINUTES","ONE_HOUR","TWO_HOURS","THREE_HOURS","SIX_HOURS","TWELVE_HOURS","ONE_DAY"],"title":"SecurityMonitoringRuleMaxSignalDuration"}}></SchemaItem><SchemaItem collapsible={true} className={"schemaItem"}><details style={{}} className={"openapi-markdown__details"}><summary style={{}}><span className={"openapi-schema__container"}><strong className={"openapi-schema__property"}>newValueOptions</strong><span className={"openapi-schema__name"}> object</span></span></summary><div style={{"marginLeft":"5px"}} className={"schema-description-container"}><div className={"schema-description"}>Options on new value rules.</div><SchemaItem collapsible={false} name={"forgetAfter"} required={false} schemaName={"int32"} qualifierMessage={"**Possible values:** [`1`, `2`, `7`, `14`, `21`, `28`]"} schema={{"description":"The duration in days after which a learned value is forgotten.","enum":[1,2,7,14,21,28],"format":"int32","type":"integer","x-enum-varnames":["ONE_DAY","TWO_DAYS","ONE_WEEK","TWO_WEEKS","THREE_WEEKS","FOUR_WEEKS"],"title":"SecurityMonitoringRuleNewValueOptionsForgetAfter"}}></SchemaItem><SchemaItem collapsible={false} name={"learningDuration"} required={false} schemaName={"int32"} qualifierMessage={"**Possible values:** [`0`, `1`, `7`]"} schema={{"description":"The duration in days during which values are learned, and after which signals will be generated for values that\nweren't learned. If set to 0, a signal will be generated for all new values after the first value is learned.","enum":[0,1,7],"format":"int32","type":"integer","x-enum-varnames":["ZERO_DAYS","ONE_DAY","SEVEN_DAYS"],"title":"SecurityMonitoringRuleNewValueOptionsLearningDuration"}}></SchemaItem></div></details></SchemaItem></div></details></SchemaItem><SchemaItem collapsible={true} className={"schemaItem"}><details style={{}} className={"openapi-markdown__details"}><summary style={{}}><span className={"openapi-schema__container"}><strong className={"openapi-schema__property"}>queries</strong><span className={"openapi-schema__name"}> object[]</span></span></summary><div style={{"marginLeft":"5px"}} className={"schema-description-container"}><div className={"schema-description"}>Queries for selecting logs which are part of the rule.</div><li className={"opening-array-bracket-container"}><div className={"opening-array-bracket"}>Array [</div></li><SchemaItem collapsible={true} className={"schemaItem"}><details style={{}} className={"openapi-markdown__details"}><summary style={{}}><span className={"openapi-schema__container"}><strong className={"openapi-schema__property"}>agentRule</strong><span className={"openapi-schema__name"}> object</span></span></summary><div style={{"marginLeft":"5px"}} className={"schema-description-container"}><div className={"schema-description"}>The Agent rule.</div><SchemaItem collapsible={false} name={"agentRuleId"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"The Agent rule ID. Must be unique within the rule.","example":"etc_shadow","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"expression"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"A Runtime Security expression determines what activity should be collected by the Datadog Agent.\nThese logical expressions can use predefined operators and attributes. Tags cannot be used in Runtime\nSecurity expressions. Instead, allow or deny based on tags under the advanced option.","type":"string"}}></SchemaItem></div></details></SchemaItem><SchemaItem collapsible={false} name={"aggregation"} required={false} schemaName={"SecurityMonitoringRuleQueryAggregation"} qualifierMessage={"**Possible values:** [`count`, `cardinality`, `sum`, `max`, `new_value`]"} schema={{"description":"The aggregation type.","enum":["count","cardinality","sum","max","new_value"],"type":"string","x-enum-varnames":["COUNT","CARDINALITY","SUM","MAX","NEW_VALUE"],"title":"SecurityMonitoringRuleQueryAggregation"}}></SchemaItem><SchemaItem collapsible={false} name={"distinctFields"} required={false} schemaName={"string[]"} qualifierMessage={undefined} schema={{"description":"Field for which the cardinality is measured. Sent as an array.","items":{"description":"Field.","type":"string"},"type":"array"}}></SchemaItem><SchemaItem collapsible={false} name={"groupByFields"} required={false} schemaName={"string[]"} qualifierMessage={undefined} schema={{"description":"Fields to group by.","items":{"description":"Field.","type":"string"},"type":"array"}}></SchemaItem><SchemaItem collapsible={false} name={"metric"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"The target field to aggregate over when using the sum or max\naggregations.","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"name"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Name of the query.","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"query"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Query to run on logs.","type":"string"}}></SchemaItem><li className={"closing-array-bracket-container"}><div className={"closing-array-bracket"}>]</div></li></div></details></SchemaItem><SchemaItem collapsible={false} name={"tags"} required={false} schemaName={"string[]"} qualifierMessage={undefined} schema={{"description":"Tags for generated signals.","items":{"description":"Tag.","type":"string"},"type":"array"}}></SchemaItem><SchemaItem collapsible={false} name={"type"} required={false} schemaName={"SecurityMonitoringRuleTypeRead"} qualifierMessage={"**Possible values:** [`log_detection`, `infrastructure_configuration`, `workload_security`, `cloud_configuration`]"} schema={{"description":"The rule type.","enum":["log_detection","infrastructure_configuration","workload_security","cloud_configuration"],"type":"string","x-enum-varnames":["LOG_DETECTION","INFRASTRUCTURE_CONFIGURATION","WORKLOAD_SECURITY","CLOUD_CONFIGURATION"],"title":"SecurityMonitoringRuleTypeRead"}}></SchemaItem><SchemaItem collapsible={false} name={"updateAuthorId"} required={false} schemaName={"int64"} qualifierMessage={undefined} schema={{"description":"User ID of the user who updated the rule.","format":"int64","type":"integer"}}></SchemaItem><SchemaItem collapsible={false} name={"version"} required={false} schemaName={"int64"} qualifierMessage={undefined} schema={{"description":"The version of the rule.","format":"int64","type":"integer"}}></SchemaItem></ul></details></TabItem><TabItem label={"Example (from schema)"} value={"Example (from schema)"}><ResponseSamples responseExample={"{\n  \"cases\": [\n    {\n      \"condition\": \"string\",\n      \"name\": \"string\",\n      \"notifications\": [\n        \"string\"\n      ],\n      \"status\": \"critical\"\n    }\n  ],\n  \"createdAt\": 0,\n  \"creationAuthorId\": 0,\n  \"filters\": [\n    {\n      \"action\": \"require\",\n      \"query\": \"string\"\n    }\n  ],\n  \"hasExtendedTitle\": true,\n  \"id\": \"string\",\n  \"isDefault\": true,\n  \"isDeleted\": true,\n  \"isEnabled\": true,\n  \"message\": \"string\",\n  \"name\": \"string\",\n  \"options\": {\n    \"detectionMethod\": \"threshold\",\n    \"evaluationWindow\": 0,\n    \"keepAlive\": 0,\n    \"maxSignalDuration\": 0,\n    \"newValueOptions\": {\n      \"forgetAfter\": 1,\n      \"learningDuration\": 0\n    }\n  },\n  \"queries\": [\n    {\n      \"agentRule\": {\n        \"agentRuleId\": \"etc_shadow\",\n        \"expression\": \"string\"\n      },\n      \"aggregation\": \"count\",\n      \"distinctFields\": [\n        \"string\"\n      ],\n      \"groupByFields\": [\n        \"string\"\n      ],\n      \"metric\": \"string\",\n      \"name\": \"string\",\n      \"query\": \"string\"\n    }\n  ],\n  \"tags\": [\n    \"string\"\n  ],\n  \"type\": \"log_detection\",\n  \"updateAuthorId\": 0,\n  \"version\": 0\n}"} language={"json"}></ResponseSamples></TabItem></SchemaTabs></TabItem></MimeTabs></div></TabItem><TabItem label={"400"} value={"400"}><div>Bad Request</div><div><MimeTabs className={"openapi-tabs__mime"} schemaType={"response"}><TabItem label={"application/json"} value={"application/json"}><SchemaTabs className={"openapi-tabs__schema"}><TabItem label={"Schema"} value={"Schema"}><details style={{}} className={"openapi-markdown__details response"} data-collapsed={false} open={true}><summary style={{}} className={"openapi-markdown__details-summary-response"}><strong>Schema</strong></summary><div style={{"textAlign":"left","marginLeft":"1rem"}} className={"response-body-description-container"}></div><ul style={{"marginLeft":"5px"}}><SchemaItem collapsible={false} name={"errors"} required={true} schemaName={"string[]"} qualifierMessage={undefined} schema={{"description":"A list of errors.","items":{"description":"A list of items.","example":"Bad Request","type":"string"},"type":"array"}}></SchemaItem></ul></details></TabItem><TabItem label={"Example (from schema)"} value={"Example (from schema)"}><ResponseSamples responseExample={"{\n  \"errors\": [\n    \"Bad Request\"\n  ]\n}"} language={"json"}></ResponseSamples></TabItem></SchemaTabs></TabItem></MimeTabs></div></TabItem><TabItem label={"401"} value={"401"}><div>Concurrent Modification</div><div><MimeTabs className={"openapi-tabs__mime"} schemaType={"response"}><TabItem label={"application/json"} value={"application/json"}><SchemaTabs className={"openapi-tabs__schema"}><TabItem label={"Schema"} value={"Schema"}><details style={{}} className={"openapi-markdown__details response"} data-collapsed={false} open={true}><summary style={{}} className={"openapi-markdown__details-summary-response"}><strong>Schema</strong></summary><div style={{"textAlign":"left","marginLeft":"1rem"}} className={"response-body-description-container"}></div><ul style={{"marginLeft":"5px"}}><SchemaItem collapsible={false} name={"errors"} required={true} schemaName={"string[]"} qualifierMessage={undefined} schema={{"description":"A list of errors.","items":{"description":"A list of items.","example":"Bad Request","type":"string"},"type":"array"}}></SchemaItem></ul></details></TabItem><TabItem label={"Example (from schema)"} value={"Example (from schema)"}><ResponseSamples responseExample={"{\n  \"errors\": [\n    \"Bad Request\"\n  ]\n}"} language={"json"}></ResponseSamples></TabItem></SchemaTabs></TabItem></MimeTabs></div></TabItem><TabItem label={"403"} value={"403"}><div>Not Authorized</div><div><MimeTabs className={"openapi-tabs__mime"} schemaType={"response"}><TabItem label={"application/json"} value={"application/json"}><SchemaTabs className={"openapi-tabs__schema"}><TabItem label={"Schema"} value={"Schema"}><details style={{}} className={"openapi-markdown__details response"} data-collapsed={false} open={true}><summary style={{}} className={"openapi-markdown__details-summary-response"}><strong>Schema</strong></summary><div style={{"textAlign":"left","marginLeft":"1rem"}} className={"response-body-description-container"}></div><ul style={{"marginLeft":"5px"}}><SchemaItem collapsible={false} name={"errors"} required={true} schemaName={"string[]"} qualifierMessage={undefined} schema={{"description":"A list of errors.","items":{"description":"A list of items.","example":"Bad Request","type":"string"},"type":"array"}}></SchemaItem></ul></details></TabItem><TabItem label={"Example (from schema)"} value={"Example (from schema)"}><ResponseSamples responseExample={"{\n  \"errors\": [\n    \"Bad Request\"\n  ]\n}"} language={"json"}></ResponseSamples></TabItem></SchemaTabs></TabItem></MimeTabs></div></TabItem><TabItem label={"404"} value={"404"}><div>Not Found</div><div><MimeTabs className={"openapi-tabs__mime"} schemaType={"response"}><TabItem label={"application/json"} value={"application/json"}><SchemaTabs className={"openapi-tabs__schema"}><TabItem label={"Schema"} value={"Schema"}><details style={{}} className={"openapi-markdown__details response"} data-collapsed={false} open={true}><summary style={{}} className={"openapi-markdown__details-summary-response"}><strong>Schema</strong></summary><div style={{"textAlign":"left","marginLeft":"1rem"}} className={"response-body-description-container"}></div><ul style={{"marginLeft":"5px"}}><SchemaItem collapsible={false} name={"errors"} required={true} schemaName={"string[]"} qualifierMessage={undefined} schema={{"description":"A list of errors.","items":{"description":"A list of items.","example":"Bad Request","type":"string"},"type":"array"}}></SchemaItem></ul></details></TabItem><TabItem label={"Example (from schema)"} value={"Example (from schema)"}><ResponseSamples responseExample={"{\n  \"errors\": [\n    \"Bad Request\"\n  ]\n}"} language={"json"}></ResponseSamples></TabItem></SchemaTabs></TabItem></MimeTabs></div></TabItem></ApiTabs></div></div>
      