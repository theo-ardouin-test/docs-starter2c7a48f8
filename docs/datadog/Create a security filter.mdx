---
id: create-security-filter
title: "Create a security filter"
description: "Create a security filter."
sidebar_label: "Create a security filter"
hide_title: true
hide_table_of_contents: true
api: eJztGmtvG7nxrxD7pS2gR+KkvdYoiups52DkYSP2tbjGho7apSRedpd7S65kVdB/78yQ3LdkOcmhwMFf7BU5nBeH8yK3QSR0mMvMSJUGp8FZLrgRjDMtwiKXZsPmMjYiH92ld+mNEMwsBfvUmmSLQkbi/o9LYzJ9Oh5HKtSjiBseqcXy11GokrFfMc1ibuYqT8a0ZrxU66FRQy1MkQ090NCi1cNCy3RRDScqlUblOMYzOf7TXQqYWKJywcQDT7JY6FEwCFQmco7yXEalRDcOxxvCDEC5+LUQ2nyvok1wug1ClRqRGvzkWRbLkBCMf9GolW2gw6VIOH411fXRYmFq9osIDSiHGybTMC4AjFTV1hRBbFTB1qqIIxbLz6BSxUJiEpnPcmTfSKGJGiixS/XKUkPhYaNAHXGHUBcVNyaXs8I4xH0IUQlcpoCQeK9WMDXvl0axmXDMR12S4gE0oYHE1G1ol/KFB3EoNeKkdRGQU4lgsVpoNs9V0scB0nRbH5x+2gYpT4THiggMX4A0AATblMNGB1oVeShO/cTufhBII5IjOCN1P8bCF3DQVppF8Cg3CNYg3UPSbDKc0CZ3lBwPjyInuBF7h6oni024CZfwKbWdY5zOHBGMjtudtuAd9nb2UMpcwLH9ZPXgWb4voe1Jw9XSENrmyS5FcQd9Vy7kec43+NvyJqIpHq6pnW1r5BaE8XAM4RjCkTxpkSB7aJbIViUfjbSlGgQPQ1wyXPEcJdK49t3VDzckUq8IbxzdcyB7i8iAZ6mnIuWzGFXT5vXfSwG677VNBvvl1jX2wuSFKDmdKRULniKZfttDZeDMHi/Q3OWzQhuwhhbME4wRqVkbO4acFvlKglVBPHiaRQ16vFOvbTSUf7Qd2qgzqXxuaYgo75wXsSHuXVSsOOgqA5d5XeTCnqIRw5kVjwvQz5JCCY/XfKPRH//cRvtz3XA7NO+b+uxwdIRB31yc/fjx8van6ZvLd7cXHw8YtzXo1sY4Pdci1BP1jEelg5Vi5xMRuXgOuHZ9WwE7B+ERB/yGpGLdZ6AVH3jUiDGdqVRbF3/y4sVX5RwWlU861ksJvrnMOo7PCPqTi9vukfuDZtXKp2UWiM3xaSdmmF1008svyR0Qdywx+5oz0ckjSKXgvWVq41YPxT2Rf+I12Eba5XK/w2yv/aYBu5eADdpPDblfFFa9Cf6OwuusgHGZPjm84jCtHcq0L0LNeax7Y+03Dul76ew30TbmroV+k2DeJlNPLnkYigxqBzbb1LPLtYxjjGSd6SenAINgBc5Aqp6NpQhqJ49JNV6CaUPdyjFuy9S8OoHJhD/IBA325OXr717/9dVfXn9XcgAwYoEZ6NGHrJktyB67QJYvz49KjF5F0fBFEQ6XL/tOTT8Dl+fPaUorTTlu51Btiegt1emDxwynydNxrVUosWDGUtdpi7xpN7ysgXmUpidEuSnAqzVftM7tBI5Pj4VoKtsiqa37YBPMFoA67PKApcqW2ggyExSlge/Nf62f+dLA8V64zOw48CqwdBOwq7eo5tdflTtNri+ZyHOo5PcrneZ704Iy2SCIgxmEByWA5uZ8zyPm88wef9WMp62c1vF2IKsFCS8Q6JAm6xyQSl89q/QrVfpBGTYpzFLlEk6M1erfnrX6lVo9U+kcVGat9ORZn1+rz1ulWMLTDXPdb010fJSgDipkUW/FBk0ZfgI5UHLt926wDfD7P40QXfXlfTyermFCBPfYX4Xiw0ZfH4zel+Aoz8MwVBFkSunQMTWcqWgzdH1U/KZgvpArYXe4GfpxKOM5QNsisWoCu6WUfcDP7V3K2B0VvXfBKaOfOID6xIG7TlJxFww8UFXi1tbiBNKyq7dbVqQSJGC7XbkSQSil9RRsqlrCTnkMSUp7Raf2hdWf/DSryLdZ8AVl1TJ3lV8Ne5enRo14F1SAO/d5X2OtW90BljsqzhoiVNUNUsEmiJsjpPBnR713bUQGe4PFjsDKhmOyKKPuZtwFtpCHnGYDixIy3IdhkUYKLaB55XMuYtFz5dNvJi1CU8i7B04pMItijmBoV528ItV8TmWjeABXhPtkEX4W2N8/ZM+VNZJx4mnyi6x9lwDPdv5s587O61ZC9l4zkv+H3eMQoFsqJJkpCmYZx/gQjPFadnUy7okMYwjcc7koLLvjngIOjcbzWOQxoPP3yVtdzCKVcJnuRlsNgWVHOsglKp6iMA42a9bG9XNvwZqLhS3NcDHd7oHwLKSWh7BR3hejbWSFfjXqjv25M1b9FgX+hO/hQq1o9h4jr5erybvtZPR0Ujw4W5MhoZlgYgMGFYksVhus1azBWAVuIcExKlTxDrWIG9/RXNUeqlHvCtLg5U0RO62df7hxbSN7j0nEmuhoE3vF8fD2IjsMoZL1V88gVVOS384UJpAOnVsIp8UE8ksS6Dfanvsq5brBdNXy7dKqbssHliOWQgvNrhCKnbC1NEvCLxPMgaVhi5ynhs1jtUbDxf+2N+9qEjp1ZxCYOoM/kn7HCgdPxquXYz+L4UqH4GHcZYFezhTPIz3NihnQnOolz4UTnc9kjKmdUYyGWQXOMErmcM5iak7X8OSCR931KynWteWtNTav7CwK3bOVNGLhkqcL0cIgILiafRRxlFkIakZTfp+GMoKRQ0x6GI0u25lQY60WxoBF7+fauURRomJ+SQPPQaEHxMyAZIfcni/EXsbAa+cyPKh46/6YgxwFg4NZ/gF9ltm+DUOPonpERhGBjaOIEcW4o9HnBbiFQ3yeA7aQbvQI9DCex62P+DwSp5YLOBYHt6MU08GOKNBAtLbucirTleVoEuOJRydhn9DYCaboGqEc3WCEU/mCp+7wt/FZAwJ8P6A7sbcbkGIkUlObHFC47qHFOfAWh79YrmK8fwQt3Ezev8NnXTgCIFlmTRqLXPVZdF0OjTbahDSFC+r1aNs3/oTieN+NPhIg7cHBiAFapfTH5Tvn50MAGb69+Kkqvi1y1yxeDUvIKUBOEXLXLIAfYeD6cQau312eTW4vrz4czci1ZQQ4wR7Hx+rZ2kX16Mjf5DZvYnuuUL/wiVTfnZ6/kKvfY9l3JY7C3sujklDt4qba+k5miKLLdK5894eH1P0REGnRjHSRZSo3/2xHea9Dtzs3FgztvZFQrNfr9lNFCzkOetpRcewOtpoziGjl3l9TSGQijTIl4eCMao2ZuoH+64RVSILa5VTwcvSCcijIp+FM1V6S7XuR2U5Baq2x38UrTmcOBtKHMZCTdJlJe7d15cYnl4mtTvodLIw2io46VO1WaYklDCDbbmdcC/BNux0OOyvFHpjPL20HzB/squQ/s4of3tp3LL4S7/Qnq0puQhebB2HrVdb11c0tAM/cY9WE8rgg52t8agJ/TwOoZ4MAn74a247Y2vFtEEM2VFifbvHiceLOm1Xe5zN5H/eBkvmptN5baPhQKwn+Rbl64f/unPI/SnA7s3dB6TMtNG76PXD8Pzx1l4w=
sidebar_class_name: "post api-method"
info_path: docs/datadog/datadog-api-v-2-collection
custom_edit_url: null
---

<h1 className={"openapi__heading"}>Create a security filter</h1>

<MethodEndpoint method={"post"} path={"/api/v2/security_monitoring/configuration/security_filters"}></MethodEndpoint>


Create a security filter.See the [security filter guide](https://docs.datadoghq.com/security_platform/guide/how-to-setup-security-filters-using-security-monitoring-api/)for more examples.
## Request
<MimeTabs className={"openapi-tabs__mime request"}><TabItem label={"application/json"} value={"application/json-schema"}><details style={{}} className={"openapi-markdown__details mime"} data-collapsed={false} open={true}><summary style={{}} className={"openapi-markdown__details-summary-mime"}><h3 className={"openapi-markdown__details-summary-header-body"}>Body</h3><strong className={"openapi-schema__required"}>required</strong></summary><div className={"body-description-container"}><div className={"body-description"}>The definition of the new security filter.</div></div><ul style={{"marginLeft":"5px"}}><SchemaItem collapsible={true} className={"schemaItem"}><details style={{}} className={"openapi-markdown__details"}><summary style={{}}><span className={"openapi-schema__container"}><strong className={"openapi-schema__property"}>data</strong><span className={"openapi-schema__name"}> object</span><span className={"openapi-schema__divider"}></span><span className={"openapi-schema__required"}>required</span></span></summary><div style={{"marginLeft":"5px"}} className={"schema-description-container"}><div className={"schema-description"}>Object for a single security filter.</div><SchemaItem collapsible={true} className={"schemaItem"}><details style={{}} className={"openapi-markdown__details"}><summary style={{}}><span className={"openapi-schema__container"}><strong className={"openapi-schema__property"}>attributes</strong><span className={"openapi-schema__name"}> object</span><span className={"openapi-schema__divider"}></span><span className={"openapi-schema__required"}>required</span></span></summary><div style={{"marginLeft":"5px"}} className={"schema-description-container"}><div className={"schema-description"}>Object containing the attributes of the security filter to be created.</div><SchemaItem collapsible={true} className={"schemaItem"}><details style={{}} className={"openapi-markdown__details"}><summary style={{}}><span className={"openapi-schema__container"}><strong className={"openapi-schema__property"}>exclusion_filters</strong><span className={"openapi-schema__name"}> object[]</span><span className={"openapi-schema__divider"}></span><span className={"openapi-schema__required"}>required</span></span></summary><div style={{"marginLeft":"5px"}} className={"schema-description-container"}><div className={"schema-description"}>Exclusion filters to exclude some logs from the security filter.</div><li className={"opening-array-bracket-container"}><div className={"opening-array-bracket"}>Array [</div></li><SchemaItem collapsible={false} name={"name"} required={true} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Exclusion filter name.","example":"Exclude staging","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"query"} required={true} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"Exclusion filter query. Logs that match this query are excluded from the security filter.","example":"source:staging","type":"string"}}></SchemaItem><li className={"closing-array-bracket-container"}><div className={"closing-array-bracket"}>]</div></li></div></details></SchemaItem><SchemaItem collapsible={false} name={"filtered_data_type"} required={true} schemaName={"SecurityFilterFilteredDataType"} qualifierMessage={"**Possible values:** [`logs`]"} schema={{"description":"The filtered data type.","enum":["logs"],"example":"logs","type":"string","x-enum-varnames":["LOGS"],"title":"SecurityFilterFilteredDataType"}}></SchemaItem><SchemaItem collapsible={false} name={"is_enabled"} required={true} schemaName={"boolean"} qualifierMessage={undefined} schema={{"description":"Whether the security filter is enabled.","example":true,"type":"boolean"}}></SchemaItem><SchemaItem collapsible={false} name={"name"} required={true} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"The name of the security filter.","example":"Custom security filter","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"query"} required={true} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"The query of the security filter.","example":"service:api","type":"string"}}></SchemaItem></div></details></SchemaItem><SchemaItem collapsible={false} name={"type"} required={true} schemaName={"SecurityFilterType"} qualifierMessage={"**Possible values:** [`security_filters`]"} schema={{"default":"security_filters","description":"The type of the resource. The value should always be `security_filters`.","enum":["security_filters"],"example":"security_filters","type":"string","x-enum-varnames":["SECURITY_FILTERS"],"title":"SecurityFilterType"}}></SchemaItem></div></details></SchemaItem></ul></details></TabItem></MimeTabs>
<div><div><ApiTabs label={undefined} id={undefined}><TabItem label={"200"} value={"200"}><div>OK</div><div><MimeTabs className={"openapi-tabs__mime"} schemaType={"response"}><TabItem label={"application/json"} value={"application/json"}><SchemaTabs className={"openapi-tabs__schema"}><TabItem label={"Schema"} value={"Schema"}><details style={{}} className={"openapi-markdown__details response"} data-collapsed={false} open={true}><summary style={{}} className={"openapi-markdown__details-summary-response"}><strong>Schema</strong></summary><div style={{"textAlign":"left","marginLeft":"1rem"}} className={"response-body-description-container"}></div><ul style={{"marginLeft":"5px"}}><SchemaItem collapsible={true} className={"schemaItem"}><details style={{}} className={"openapi-markdown__details"}><summary style={{}}><span className={"openapi-schema__container"}><strong className={"openapi-schema__property"}>data</strong><span className={"openapi-schema__name"}> object</span></span></summary><div style={{"marginLeft":"5px"}} className={"schema-description-container"}><div className={"schema-description"}>The security filter's properties.</div><SchemaItem collapsible={true} className={"schemaItem"}><details style={{}} className={"openapi-markdown__details"}><summary style={{}}><span className={"openapi-schema__container"}><strong className={"openapi-schema__property"}>attributes</strong><span className={"openapi-schema__name"}> object</span></span></summary><div style={{"marginLeft":"5px"}} className={"schema-description-container"}><div className={"schema-description"}>The object describing a security filter.</div><SchemaItem collapsible={true} className={"schemaItem"}><details style={{}} className={"openapi-markdown__details"}><summary style={{}}><span className={"openapi-schema__container"}><strong className={"openapi-schema__property"}>exclusion_filters</strong><span className={"openapi-schema__name"}> object[]</span></span></summary><div style={{"marginLeft":"5px"}} className={"schema-description-container"}><div className={"schema-description"}>The list of exclusion filters applied in this security filter.</div><li className={"opening-array-bracket-container"}><div className={"opening-array-bracket"}>Array [</div></li><SchemaItem collapsible={false} name={"name"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"The exclusion filter name.","example":"Exclude staging","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"query"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"The exclusion filter query.","example":"source:staging","type":"string"}}></SchemaItem><li className={"closing-array-bracket-container"}><div className={"closing-array-bracket"}>]</div></li></div></details></SchemaItem><SchemaItem collapsible={false} name={"filtered_data_type"} required={false} schemaName={"SecurityFilterFilteredDataType"} qualifierMessage={"**Possible values:** [`logs`]"} schema={{"description":"The filtered data type.","enum":["logs"],"example":"logs","type":"string","x-enum-varnames":["LOGS"],"title":"SecurityFilterFilteredDataType"}}></SchemaItem><SchemaItem collapsible={false} name={"is_builtin"} required={false} schemaName={"boolean"} qualifierMessage={undefined} schema={{"description":"Whether the security filter is the built-in filter.","example":false,"type":"boolean"}}></SchemaItem><SchemaItem collapsible={false} name={"is_enabled"} required={false} schemaName={"boolean"} qualifierMessage={undefined} schema={{"description":"Whether the security filter is enabled.","example":false,"type":"boolean"}}></SchemaItem><SchemaItem collapsible={false} name={"name"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"The security filter name.","example":"Custom security filter","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"query"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"The security filter query. Logs accepted by this query will be accepted by this filter.","example":"service:api","type":"string"}}></SchemaItem><SchemaItem collapsible={false} name={"version"} required={false} schemaName={"int32"} qualifierMessage={"**Possible values:** `<= 2147483647`"} schema={{"description":"The version of the security filter.","example":1,"format":"int32","maximum":2147483647,"type":"integer"}}></SchemaItem></div></details></SchemaItem><SchemaItem collapsible={false} name={"id"} required={false} schemaName={"SecurityFilterID"} qualifierMessage={undefined} schema={{"description":"The ID of the security filter.","example":"3dd-0uc-h1s","type":"string","title":"SecurityFilterID"}}></SchemaItem><SchemaItem collapsible={false} name={"type"} required={false} schemaName={"SecurityFilterType"} qualifierMessage={"**Possible values:** [`security_filters`]"} schema={{"default":"security_filters","description":"The type of the resource. The value should always be `security_filters`.","enum":["security_filters"],"example":"security_filters","type":"string","x-enum-varnames":["SECURITY_FILTERS"],"title":"SecurityFilterType"}}></SchemaItem></div></details></SchemaItem><SchemaItem collapsible={true} className={"schemaItem"}><details style={{}} className={"openapi-markdown__details"}><summary style={{}}><span className={"openapi-schema__container"}><strong className={"openapi-schema__property"}>meta</strong><span className={"openapi-schema__name"}> object</span></span></summary><div style={{"marginLeft":"5px"}} className={"schema-description-container"}><div className={"schema-description"}>Optional metadata associated to the response.</div><SchemaItem collapsible={false} name={"warning"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"description":"A warning message.","example":"All the security filters are disabled. As a result, no logs are being analyzed.","type":"string"}}></SchemaItem></div></details></SchemaItem></ul></details></TabItem><TabItem label={"Example (from schema)"} value={"Example (from schema)"}><ResponseSamples responseExample={"{\n  \"data\": {\n    \"attributes\": {\n      \"exclusion_filters\": [\n        {\n          \"name\": \"Exclude staging\",\n          \"query\": \"source:staging\"\n        }\n      ],\n      \"filtered_data_type\": \"logs\",\n      \"is_builtin\": false,\n      \"is_enabled\": false,\n      \"name\": \"Custom security filter\",\n      \"query\": \"service:api\",\n      \"version\": 1\n    },\n    \"id\": \"3dd-0uc-h1s\",\n    \"type\": \"security_filters\"\n  },\n  \"meta\": {\n    \"warning\": \"All the security filters are disabled. As a result, no logs are being analyzed.\"\n  }\n}"} language={"json"}></ResponseSamples></TabItem></SchemaTabs></TabItem></MimeTabs></div></TabItem><TabItem label={"400"} value={"400"}><div>Bad Request</div><div><MimeTabs className={"openapi-tabs__mime"} schemaType={"response"}><TabItem label={"application/json"} value={"application/json"}><SchemaTabs className={"openapi-tabs__schema"}><TabItem label={"Schema"} value={"Schema"}><details style={{}} className={"openapi-markdown__details response"} data-collapsed={false} open={true}><summary style={{}} className={"openapi-markdown__details-summary-response"}><strong>Schema</strong></summary><div style={{"textAlign":"left","marginLeft":"1rem"}} className={"response-body-description-container"}></div><ul style={{"marginLeft":"5px"}}><SchemaItem collapsible={false} name={"errors"} required={true} schemaName={"string[]"} qualifierMessage={undefined} schema={{"description":"A list of errors.","items":{"description":"A list of items.","example":"Bad Request","type":"string"},"type":"array"}}></SchemaItem></ul></details></TabItem><TabItem label={"Example (from schema)"} value={"Example (from schema)"}><ResponseSamples responseExample={"{\n  \"errors\": [\n    \"Bad Request\"\n  ]\n}"} language={"json"}></ResponseSamples></TabItem></SchemaTabs></TabItem></MimeTabs></div></TabItem><TabItem label={"403"} value={"403"}><div>Not Authorized</div><div><MimeTabs className={"openapi-tabs__mime"} schemaType={"response"}><TabItem label={"application/json"} value={"application/json"}><SchemaTabs className={"openapi-tabs__schema"}><TabItem label={"Schema"} value={"Schema"}><details style={{}} className={"openapi-markdown__details response"} data-collapsed={false} open={true}><summary style={{}} className={"openapi-markdown__details-summary-response"}><strong>Schema</strong></summary><div style={{"textAlign":"left","marginLeft":"1rem"}} className={"response-body-description-container"}></div><ul style={{"marginLeft":"5px"}}><SchemaItem collapsible={false} name={"errors"} required={true} schemaName={"string[]"} qualifierMessage={undefined} schema={{"description":"A list of errors.","items":{"description":"A list of items.","example":"Bad Request","type":"string"},"type":"array"}}></SchemaItem></ul></details></TabItem><TabItem label={"Example (from schema)"} value={"Example (from schema)"}><ResponseSamples responseExample={"{\n  \"errors\": [\n    \"Bad Request\"\n  ]\n}"} language={"json"}></ResponseSamples></TabItem></SchemaTabs></TabItem></MimeTabs></div></TabItem><TabItem label={"409"} value={"409"}><div>Conflict</div><div><MimeTabs className={"openapi-tabs__mime"} schemaType={"response"}><TabItem label={"application/json"} value={"application/json"}><SchemaTabs className={"openapi-tabs__schema"}><TabItem label={"Schema"} value={"Schema"}><details style={{}} className={"openapi-markdown__details response"} data-collapsed={false} open={true}><summary style={{}} className={"openapi-markdown__details-summary-response"}><strong>Schema</strong></summary><div style={{"textAlign":"left","marginLeft":"1rem"}} className={"response-body-description-container"}></div><ul style={{"marginLeft":"5px"}}><SchemaItem collapsible={false} name={"errors"} required={true} schemaName={"string[]"} qualifierMessage={undefined} schema={{"description":"A list of errors.","items":{"description":"A list of items.","example":"Bad Request","type":"string"},"type":"array"}}></SchemaItem></ul></details></TabItem><TabItem label={"Example (from schema)"} value={"Example (from schema)"}><ResponseSamples responseExample={"{\n  \"errors\": [\n    \"Bad Request\"\n  ]\n}"} language={"json"}></ResponseSamples></TabItem></SchemaTabs></TabItem></MimeTabs></div></TabItem><TabItem label={"429"} value={"429"}><div>Too many requests</div><div><MimeTabs className={"openapi-tabs__mime"} schemaType={"response"}><TabItem label={"application/json"} value={"application/json"}><SchemaTabs className={"openapi-tabs__schema"}><TabItem label={"Schema"} value={"Schema"}><details style={{}} className={"openapi-markdown__details response"} data-collapsed={false} open={true}><summary style={{}} className={"openapi-markdown__details-summary-response"}><strong>Schema</strong></summary><div style={{"textAlign":"left","marginLeft":"1rem"}} className={"response-body-description-container"}></div><ul style={{"marginLeft":"5px"}}><SchemaItem collapsible={false} name={"errors"} required={true} schemaName={"string[]"} qualifierMessage={undefined} schema={{"description":"A list of errors.","items":{"description":"A list of items.","example":"Bad Request","type":"string"},"type":"array"}}></SchemaItem></ul></details></TabItem><TabItem label={"Example (from schema)"} value={"Example (from schema)"}><ResponseSamples responseExample={"{\n  \"errors\": [\n    \"Bad Request\"\n  ]\n}"} language={"json"}></ResponseSamples></TabItem></SchemaTabs></TabItem></MimeTabs></div></TabItem></ApiTabs></div></div>
      